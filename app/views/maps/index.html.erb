<h2>gmap</h2>
<input id="address" type="textbox" value="GeekSalon">
<input type="button" value="検索" onclick="codeAddress()">

<div id="display">緯度経度を表示</div>
<button id = "find-me">現在地を取得して地図上に表示</button><br/>


<p id = "status"></p>
<a id = "map-link" target="_blank"></a>
<script>
  function initMap(){
    geocoder = new google.maps.Geocoder()

    map = new google.maps.Map(document.getElementById('map'), {
      center: {lat: 40.7828, lng:-73.9653},
      zoom: 12,
    });

    marker = new google.maps.Marker({
      position:  {lat: 40.7828, lng:-73.9653},
      map: map
    });
  }
</script>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    geoFindMe()
  });
function geoFindMe() {

  const status = document.querySelector('#status');
  const mapLink = document.querySelector('#map-link');

  function success(position) {
    const latitude = position.coords.latitude;
    const longitude = position.coords.longitude;

    status.textContent = '';
    mapLink.textContent = `Latitude: ${latitude} °, Longitude: ${longitude} °`;

    // Googleマップを表示するための設定を行います
    var mapOptions = {
      center: { lat: latitude, lng: longitude },
      zoom: 16
    };

    // Googleマップを作成します
    var map = new google.maps.Map(document.getElementById("map"), mapOptions);

    // ピンを立てるためのマーカーを作成します
    var marker = new google.maps.Marker({
      position: { lat: latitude, lng: longitude },
      map: map,
      title: "現在地"
    });
  }

  function error() {
    status.textContent = 'Unable to retrieve your location';
  }

  if (!navigator.geolocation) {
    status.textContent = 'Geolocation is not supported by your browser';
  } else {
    status.textContent = 'Locating…';
    navigator.geolocation.getCurrentPosition(success, error);
  }

  
}
// document.querySelector('#find-me').addEventListener('click', geoFindMe);

</script>


<div id='map'></div>




<style>
#map {
  height: 600px;
  width: 600px;
}
</style>

<script>
let map


const display = document.getElementById('display')



// let geocoder

// function codeAddress(){
//   let inputAddress = document.getElementById('address').value;

//   // geocoder.geocode( { 'address': inputAddress}, function(results, status) {
//   //   if (status == 'OK') {
//   //     map.setCenter(results[0].geometry.location);
//   //     var marker = new google.maps.Marker({
//   //         map: map,
//   //         position: results[0].geometry.location
//   //     });
//   //     display.textContent = "検索結果：" + results[ 0 ].geometry.location
//   //   } else {
//   //     alert('該当する結果がありませんでした：' + status);
//   //   }
//   // });
// }

</script>
<script src="https://maps.googleapis.com/maps/api/js?key=<%= ENV['GOOGLE_MAP_API_KEY'] %>&callback=initMap" async defer></script>

